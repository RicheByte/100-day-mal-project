# Advanced Malware Analysis Toolkit

A lightweight Python script to automate both static and dynamic analysis of Windows malware samples‚Äîideal for educational and research purposes in a controlled environment.

## üîß What It Does

1. **Static Analysis**  
   - Calculates MD5, SHA-1, SHA-256 hashes  
   - Checks reputation via VirusTotal API  
   - Parses PE headers (entry point, sections) with `pefile`  
   - Scans against custom YARA rules  

2. **Dynamic Analysis**  
   - Launches the sample in a sandboxed VM/process  
   - Monitors CPU & memory with `psutil`  
   - Captures network traffic (TCP/UDP) via Scapy  
   - Watches file-system events with `watchdog`  
   - Hooks common WinAPI calls (e.g., `CreateFileW`, `InternetOpenW`) using Frida  

3. **Reporting**  
   - Appends all findings to `malware_analysis_report.txt`

## ‚öôÔ∏è Prerequisites

- Python 3.7+  
- Windows host or VM  
- Install dependencies:
```bash
pip install pefile yara-python psutil scapy watchdog frida requests
```

## ‚öôÔ∏è Configuration

* `MALWARE_PATH` ‚Äì path to your `.exe` sample
* `YARA_RULES_PATH` ‚Äì path to your `.yar` file
* `VIRUSTOTAL_API_KEY` ‚Äì set your VirusTotal API key
* `REPORT_FILE` ‚Äì output report filename

## üöÄ Usage

```bash
python analyze.py path/to/malware_sample.exe --runtime 120
```

* `--runtime` (seconds) controls how long dynamic analysis runs (default: 60s).
* After completion, review `malware_analysis_report.txt` for hashes, YARA hits, PE details, network logs, FS events, API calls, and resource usage.

---

> ‚ö†Ô∏è **Warning:** Run only in isolated/sandboxed environments. This tool is for education and defensive research‚Äîdo **not** use on production systems.
